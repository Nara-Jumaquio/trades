<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Trade Guide</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 20px; background: #f5f5f5; }
    h1 { text-align: center; font-size: 2em; color: #2d3748; margin-bottom: 30px;}
    .legend {
      max-width: 700px;
      margin: 0 auto 20px auto;
      background: #e2e8f0;
      padding: 15px 20px;
      border-radius: 8px;
      font-size: 0.9em;
      color: #2d3748;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .legend p { margin: 6px 0; }
    .legend strong { text-decoration: underline; }

    .tabs { display: flex; justify-content: center; gap: 20px; margin: 20px 0; }
    .tab-btn { padding: 10px 20px; background: #e2e8f0; border: none; cursor: pointer; border-radius: 5px; }
    .tab-btn.active { background: #4F46E5; color: white; }

    .content { display: none; max-width: 700px; margin: 0 auto; }
    .content.active { display: block; }

    .trade-list {
      white-space: pre-line;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      font-family: monospace;
      font-size: 1em;
      line-height: 1.5em;
      color: #2d3748;
    }

  </style>
</head>
<body>
  <h1>Trade Guide</h1>

  <div class="legend">
    <p><strong>TSU (Trade Score Unit):</strong> A calculated value that represents how valuable or tradable an item is based on its rarity, how hard it is to get, and its usefulness. Higher TSU = more value.</p>
    <p><strong>Formula:</strong> <code>TSU = R × LI × √U</code></p>
    <p><strong>R (Rarity):</strong> How rare the item is — affects its value and demand.</p>
    <p><strong>LI (Labor Intensity):</strong> How hard or time-consuming it is to obtain.</p>
    <p><strong>U (Usefulness):</strong> The usefulness or magical potential of the item.</p>
  </div>

  <div class="tabs">
    <button class="tab-btn active" onclick="showTab('exchange')">Exchange Rates</button>
    <button class="tab-btn" onclick="showTab('chart')">Graph View</button>
  </div>

  <div id="exchange" class="content active">
    <div class="trade-list" id="tradeList">
      <!-- Trade info inserted by JS -->
    </div>
  </div>

  <div id="chart" class="content">
    <!-- Placeholder for graph if needed -->
    <p style="text-align:center; color:#888;">Graph View coming soon.</p>
  </div>

  <script>
    const items = [
      { name: "Books", R: 2, LI: 2, U: 3 },
      { name: "Wood Logs", R: 2, LI: 2, U: 5 },
      { name: "Cobblestone", R: 1, LI: 1, U: 5 },
      { name: "Coal", R: 2, LI: 2, U: 4 },
      { name: "Iron", R: 5, LI: 4, U: 3 },
      { name: "Gold", R: 6, LI: 5, U: 8 },
      { name: "Lapis", R: 5, LI: 4, U: 7 },
      { name: "Emerald", R: 8, LI: 6, U: 5 },
      { name: "Diamond", R: 9, LI: 7, U: 10 },
      { name: "Obsidian", R: 7, LI: 9, U: 3 },
      { name: "Golden Apple", R: 9, LI: 7, U: 10 },
      { name: "God Apple", R: 10, LI: 10, U: 10 }
    ];

    function calculateTSU(R, LI, U) {
      return Math.round(R * LI * Math.sqrt(U));
    }

    // Sort items by TSU descending
    items.forEach(item => {
      item.TSU = calculateTSU(item.R, item.LI, item.U);
    });
    items.sort((a,b) => b.TSU - a.TSU);

    // Function to get recommended trades for an item based on TSU rules
    function getRecommendedTrades(itemIndex) {
      const item = items[itemIndex];
      const itemTSU = item.TSU;

      // Items can trade with up to 2 items above it in TSU (higher TSU values)
      // except special rules:
      // - Emerald cannot trade for Obsidian
      // - Obsidian requires 20 Diamonds per 1 Obsidian
      // - Golden Apple requires 20 Diamonds per 1 Golden Apple
      // - God Apple requires 40 Diamonds per 1 God Apple

      const recommended = [];

      // Special cases first
      if (item.name === "Obsidian") {
        recommended.push("20 Diamonds for 1 Obsidian");
      } else if (item.name === "Golden Apple") {
        recommended.push("20 Diamonds for 1 Golden Apple");
      } else if (item.name === "God Apple") {
        recommended.push("40 Diamonds for 1 God Apple");
      } else {
        // Find up to two items with higher TSU that this item can trade for
        // Higher TSU means items with index less than itemIndex (sorted descending)
        let count = 0;
        for (let i = 0; i < itemIndex && count < 2; i++) {
          // Prevent Emerald->Obsidian trade
          if (item.name === "Emerald" && items[i].name === "Obsidian") {
            continue;
          }
          recommended.push(items[i].name);
          count++;
        }
      }

      return recommended.length > 0 ? recommended.join(", ") : "No recommended trades";
    }

    function generateTradeList() {
      let text = "";
      items.forEach((item, idx) => {
        text += `${item.name}\n`;
        text += `TSU: ${item.TSU}\n`;
        text += `R: ${item.R}/10 | LI: ${item.LI}/10 | U: ${item.U}/10\n`;
        text += `Recommended Trade: ${getRecommendedTrades(idx)}\n\n`;
      });
      return text.trim();
    }

    // Render trade list in the tradeList div
    document.getElementById("tradeList").textContent = generateTradeList();

    // Tabs logic
    function showTab(tabName) {
      document.querySelectorAll(".content").forEach(c => c.classList.remove("active"));
      document.getElementById(tabName).classList.add("active");

      document.querySelectorAll(".tab-btn").forEach(btn => btn.classList.remove("active"));
      document.querySelector(`button[onclick="showTab('${tabName}')"]`).classList.add("active");
    }
  </script>
</body>
</html>
